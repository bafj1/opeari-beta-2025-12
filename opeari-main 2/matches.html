<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Find perfect caregiver matches for your family with Opeari's smart matching system. Connect with verified, trusted childcare providers in your area.">
    <meta name="keywords" content="childcare, nanny, babysitter, caregiver matching, family care, Opeari">
    <meta name="author" content="Opeari">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://opeari.com/matches">
    <meta property="og:title" content="Your Perfect Caregiver Matches | Opeari">
    <meta property="og:description" content="Find amazing caregivers who love what they do. Smart matching based on your family's specific needs.">
    <meta property="og:image" content="https://opeari.com/images/pear-match.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://opeari.com/matches">
    <meta property="twitter:title" content="Your Perfect Caregiver Matches | Opeari">
    <meta property="twitter:description" content="Find amazing caregivers who love what they do. Smart matching based on your family's specific needs.">
    <meta property="twitter:image" content="https://opeari.com/images/pear-match.png">
    
    <title>Your Perfect Caregiver Matches | Opeari</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Opeari Brand Colors */
            --mint: #82c4ad;
            --peach: #ffdab9;
            --dark-green: #1e6b4e;
            --soft-yellow: #dfeea9;
            --turquoise: #41e3c1;
            --cream: #fef9f6;
            --warm-white: #ffffff;
            --text-dark: #2c3e50;
            --text-light: #5a6c7d;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            
            /* Extended Palette */
            --peach-light: #fff5f0;
            --mint-light: #e8f5f0;
            --background: linear-gradient(135deg, var(--cream) 0%, var(--soft-yellow) 100%);
            --highlight-soft: rgba(130, 196, 173, 0.1);
            
            /* Spacing & Effects */
            --border-radius: 20px;
            --border-radius-small: 12px;
            --shadow: 0 8px 25px rgba(30, 107, 78, 0.12);
            --shadow-hover: 0 12px 35px rgba(30, 107, 78, 0.18);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comfortaa', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
        }

        /* Header Styles */
        .site-header {
            background: var(--mint-light);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo img {
            height: 40px;
            width: auto;
        }

        .logo-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-green);
        }

        .main-nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .language-switch {
            display: flex;
            gap: 5px;
            margin-right: 20px;
        }

        .lang-option {
            color: var(--text-dark);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .lang-option.active, .lang-option:hover {
            background: var(--mint);
            color: white;
        }

        .nav-link {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 8px 0;
            border-bottom: 2px solid transparent;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--dark-green);
            border-bottom-color: var(--mint);
        }

        .cta-button {
            background: linear-gradient(135deg, var(--mint), var(--peach));
            color: white;
            padding: 12px 24px;
            border-radius: var(--border-radius-small);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(130, 196, 173, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(130, 196, 173, 0.4);
        }

        /* Mobile Menu */
        .mobile-menu-toggle {
            display: none; /* Hidden until functionality is added */
            flex-direction: column;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
        }

        .mobile-menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--dark-green);
            border-radius: 2px;
            transition: var(--transition);
        }

        /* Reusable Utility Classes */
        .card {
            background: var(--warm-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .card.hover-scale:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .gradient-mint-peach {
            background: linear-gradient(135deg, var(--mint) 0%, var(--peach) 100%);
        }

        .gradient-turquoise-yellow {
            background: linear-gradient(135deg, var(--turquoise) 0%, var(--soft-yellow) 100%);
        }

        .text-gradient {
            background: linear-gradient(135deg, var(--dark-green), var(--mint));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 30px;
            background: var(--warm-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient-mint-peach);
        }

        .page-header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 700;
            color: var(--dark-green);
        }

        .page-header p {
            font-size: 1.3rem;
            color: var(--text-light);
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
        }

        .match-explanation {
            background: var(--warm-white);
            border-radius: var(--border-radius-small);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border-left: 6px solid var(--turquoise);
        }

        .match-explanation h3 {
            color: var(--dark-green);
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .match-explanation p {
            color: var(--text-light);
            line-height: 1.7;
            font-weight: 400;
        }

        .filters-section {
            background: var(--warm-white);
            border-radius: var(--border-radius-small);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group label {
            font-weight: 600;
            color: var(--dark-green);
            font-size: 0.95rem;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid var(--mint);
            border-radius: var(--border-radius-small);
            font-family: 'Comfortaa', sans-serif;
            font-weight: 500;
            background: var(--warm-white);
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:hover, .filter-select:focus {
            border-color: var(--turquoise);
            outline: none;
            box-shadow: 0 0 0 3px rgba(65, 227, 193, 0.1);
        }

        .loading {
            text-align: center;
            color: var(--text-dark);
            font-size: 1.2rem;
            margin: 50px 0;
            background: var(--warm-white);
            padding: 50px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .spinner {
            border: 3px solid var(--mint-light);
            border-radius: 50%;
            border-top: 3px solid var(--turquoise);
            width: 45px;
            height: 45px;
            animation: spin 1s linear infinite;
            margin: 25px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .provider-card {
            background: var(--warm-white);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .provider-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-turquoise-yellow);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .provider-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-hover);
            border-color: var(--mint);
        }

        .provider-card:hover::before {
            transform: scaleX(1);
        }

        .provider-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
            gap: 20px;
        }

        .provider-info-header {
            display: flex;
            align-items: center;
            gap: 18px;
            flex: 1;
        }

        .provider-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--gradient-mint-peach);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            font-weight: 700;
            flex-shrink: 0;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(130, 196, 173, 0.3);
        }

        .provider-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .provider-details {
            flex: 1;
        }

        .provider-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .background-check {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            padding: 6px 12px;
            border-radius: var(--border-radius-small);
            font-weight: 600;
        }

        .check-passed {
            background: var(--highlight-soft);
            color: var(--success);
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .check-pending {
            background: var(--peach-light);
            color: var(--warning);
            border: 1px solid rgba(255, 152, 0, 0.3);
        }

        .match-score {
            background: var(--gradient-mint-peach);
            color: white;
            padding: 12px 18px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 700;
            text-align: center;
            min-width: 90px;
            box-shadow: 0 4px 15px rgba(130, 196, 173, 0.3);
        }

        .provider-info {
            margin-bottom: 25px;
        }

        .info-section {
            margin-bottom: 18px;
        }

        .info-label {
            font-weight: 700;
            color: var(--dark-green);
            margin-bottom: 10px;
            display: block;
            font-size: 0.95rem;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            background: var(--gradient-turquoise-yellow);
            color: var(--text-dark);
            padding: 8px 14px;
            border-radius: var(--border-radius-small);
            font-size: 0.85rem;
            font-weight: 600;
            transition: var(--transition);
            border: 1px solid rgba(65, 227, 193, 0.2);
        }

        .tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(65, 227, 193, 0.2);
        }

        .tag-more {
            background: var(--soft-yellow);
            color: var(--dark-green);
            cursor: pointer;
            border: 1px solid var(--mint);
        }

        .tag-more:hover {
            background: var(--mint);
            color: white;
        }

        .rate-location {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 15px;
            background: var(--highlight-soft);
            border-radius: var(--border-radius-small);
            border: 1px solid rgba(130, 196, 173, 0.2);
        }

        .rate {
            font-weight: 700;
            color: var(--dark-green);
            font-size: 1.1rem;
        }

        .location {
            color: var(--text-light);
            font-weight: 500;
        }

        .match-details {
            background: var(--highlight-soft);
            border-radius: var(--border-radius-small);
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid var(--turquoise);
        }

        .match-details h4 {
            color: var(--dark-green);
            font-size: 1rem;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .match-details ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .match-details li {
            font-size: 0.9rem;
            color: var(--text-light);
            padding: 4px 0;
            position: relative;
            padding-left: 25px;
            font-weight: 500;
        }

        .match-details li:before {
            content: "✓";
            position: absolute;
            left: 0;
            font-size: 1rem;
            color: var(--success);
            font-weight: bold;
        }

        .card-actions {
            display: flex;
            gap: 12px;
            margin-top: 25px;
        }

        .btn {
            border: none;
            border-radius: var(--border-radius-small);
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Comfortaa', sans-serif;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            flex: 1;
            background: var(--gradient-mint-peach);
            color: white;
            padding: 14px 24px;
            box-shadow: 0 4px 15px rgba(130, 196, 173, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(130, 196, 173, 0.4);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: var(--warm-white);
            border: 2px solid var(--mint);
            color: var(--dark-green);
            padding: 12px 18px;
        }

        .btn-secondary:hover, .btn-secondary.favorited {
            background: var(--mint);
            color: white;
            transform: translateY(-1px);
        }

        .toast {
            position: fixed;
            top: 25px;
            right: 25px;
            background: var(--gradient-mint-peach);
            color: white;
            padding: 18px 24px;
            border-radius: var(--border-radius-small);
            box-shadow: var(--shadow-hover);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast.error {
            background: linear-gradient(135deg, var(--error), #e57373);
        }

        .no-matches {
            text-align: center;
            background: var(--warm-white);
            padding: 60px 40px;
            border-radius: var(--border-radius);
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .no-matches h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--dark-green);
            font-weight: 700;
        }

        .no-matches p {
            font-size: 1.2rem;
            color: var(--text-light);
            line-height: 1.7;
            font-weight: 500;
            max-width: 500px;
            margin: 0 auto;
        }

        .error {
            background: rgba(244, 67, 54, 0.1);
            border: 2px solid rgba(244, 67, 54, 0.3);
            color: #d32f2f;
            padding: 25px;
            border-radius: var(--border-radius-small);
            margin: 25px 0;
            font-weight: 600;
        }

        .perry-helper {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            background: var(--gradient-mint-peach);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            box-shadow: var(--shadow-hover);
            transition: var(--transition);
            z-index: 100;
            animation: perry-bounce 3s ease-in-out infinite;
        }

        .perry-helper:hover {
            transform: scale(1.1);
            animation: none;
        }

        @keyframes perry-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .profile-incomplete-banner {
            background: var(--gradient-turquoise-yellow);
            color: var(--text-dark);
            padding: 20px;
            border-radius: var(--border-radius-small);
            margin-bottom: 30px;
            text-align: center;
            font-weight: 600;
            box-shadow: var(--shadow);
        }

        .profile-incomplete-banner a {
            color: var(--dark-green);
            text-decoration: none;
            font-weight: 700;
            border-bottom: 2px solid var(--dark-green);
            padding-bottom: 2px;
            transition: var(--transition);
        }

        .profile-incomplete-banner a:hover {
            color: var(--mint);
            border-color: var(--mint);
        }

        /* Footer Styles */
        .site-footer {
            background: var(--dark-green);
            color: var(--warm-white);
            margin-top: 40px;
            padding: 30px 0 20px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
        }

        .footer-section h4 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--mint);
        }

        .footer-section p {
            line-height: 1.7;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.9);
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            display: block;
            margin-bottom: 10px;
        }

        .footer-link:hover {
            color: var(--mint);
            transform: translateX(5px);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: white;
            transition: var(--transition);
        }

        .social-link:hover {
            background: var(--mint);
            transform: translateY(-2px);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 30px;
            padding-top: 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }

        @media (max-width: 768px) {
            .main-nav {
                display: none; /* Will be replaced with functional mobile menu later */
            }

            .matches-grid {
                grid-template-columns: 1fr;
            }
            
            .page-header h1 {
                font-size: 2.2rem;
            }
            
            .provider-card {
                padding: 25px;
            }

            .filters-section {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .filter-group {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }

            .provider-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
                gap: 15px;
            }

            .card-actions {
                flex-direction: column;
            }

            .perry-helper {
                bottom: 20px;
                right: 20px;
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 30px;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .header-content {
                padding: 15px;
            }

            .logo-text {
                font-size: 1.5rem;
            }

            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Site Header -->
    <header class="site-header">
        <div class="header-content">
            <a href="/" class="logo">
                <img src="/images/logo.png" alt="Opeari Logo" onerror="this.style.display='none'" />
                <span class="logo-text">Opeari</span>
            </a>
            
            <nav class="main-nav">
                <div class="language-switch">
                    <a href="#" class="lang-option active">EN</a>
                    <a href="#" class="lang-option">ES</a>
                </div>
                <a href="/about" class="nav-link">About</a>
                <a href="/how-it-works" class="nav-link">How It Works</a>
                <a href="/faq" class="nav-link">FAQ</a>
                <a href="/matches" class="nav-link active">Matches</a>
                <a href="/request-invite" class="cta-button">Request Invite</a>
            </nav>

            <div class="mobile-menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <div class="page-header">
                <h1 class="text-gradient">Your Perfect Caregiver Matches</h1>
                <p id="subtitle">Finding amazing caregivers who love what they do</p>
            </div>

            <div id="profile-incomplete" class="profile-incomplete-banner" style="display: none;">
                <strong>Complete your profile to get even better matches!</strong> <a href="/profile.html">Finish setup</a>
            </div>

            <div class="match-explanation">
                <h3>How We Find Your Perfect Matches</h3>
                <p>We match caregivers using a custom score based on your unique needs — from care type and age group to schedule, languages, and neighborhood. Verified caregivers score higher so you can feel confident in every connection.</p>
                <p style="margin-top: 10px; font-size: 0.9rem; color: var(--text-light); font-style: italic;">Note: Only matches 40% and above are shown to ensure quality connections.</p>
            </div>

            <div class="filters-section">
                <div class="filter-group">
                    <label for="sort-filter">Sort by:</label>
                    <label for="sort-filter" class="visually-hidden">Sort caregivers by preference</label>
                    <select id="sort-filter" class="filter-select" aria-label="Sort caregivers">
                        <option value="score">Best Match</option>
                        <option value="rate-low">Lowest Rate</option>
                        <option value="rate-high">Premium Care</option>
                        <option value="name">Name A-Z</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="bg-filter">Verification:</label>
                    <label for="bg-filter" class="visually-hidden">Filter by background check status</label>
                    <select id="bg-filter" class="filter-select" aria-label="Filter by background check status">
                        <option value="all">All Caregivers</option>
                        <option value="verified">Verified Only</option>
                    </select>
                </div>
            </div>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Finding your perfect caregivers...</p>
            </div>

            <div id="error" class="error" style="display: none;"></div>

            <div id="matches-container">
                <!-- Matches will be populated here -->
            </div>
        </div>

        <div class="perry-helper" onclick="showHelp()" title="Hi! I'm Perry - Click for help!">
            <img src="/images/perry-help.png" alt="Perry Helper" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;" onerror="this.style.display='none'; this.parentElement.innerHTML='?';" />
        </div>

        <div id="toast" class="toast"></div>
    </div>

    <!-- Site Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Opeari</h4>
                <p>Connecting families with amazing caregivers through smart matching and community trust.</p>
                <div class="social-links">
                    <a href="#" class="social-link" aria-label="Facebook">f</a>
                    <a href="#" class="social-link" aria-label="Instagram">ig</a>
                    <a href="#" class="social-link" aria-label="Twitter">tw</a>
                    <a href="#" class="social-link" aria-label="LinkedIn">in</a>
                </div>
            </div>
            
            <div class="footer-section">
                <h4>For Families</h4>
                <a href="/find-care" class="footer-link">Find Care</a>
                <a href="/how-it-works" class="footer-link">How It Works</a>
                <a href="/safety" class="footer-link">Safety</a>
                <a href="/pricing" class="footer-link">Pricing</a>
            </div>
            
            <div class="footer-section">
                <h4>For Caregivers</h4>
                <a href="/join-caregivers" class="footer-link">Join as Caregiver</a>
                <a href="/resources" class="footer-link">Resources</a>
                <a href="/background-check" class="footer-link">Background Check</a>
                <a href="/community" class="footer-link">Community</a>
            </div>
            
            <div class="footer-section">
                <h4>Support</h4>
                <a href="/contact" class="footer-link">Contact Us</a>
                <a href="/faq" class="footer-link">FAQ</a>
                <a href="/help" class="footer-link">Help Center</a>
                <a href="/terms" class="footer-link">Terms</a>
                <a href="/privacy" class="footer-link">Privacy</a>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2024 Opeari. All rights reserved.</p>
        </div>
    </footer>

    <script>
        let allMatches = [];
        let favorites = JSON.parse(localStorage.getItem('opeari_favorites') || '[]');

        function checkAuthentication() {
            const session = JSON.parse(localStorage.getItem('opeari_session') || '{}');
            
            if (!session.user || session.user.role !== 'parent') {
                window.location.href = '/login.html?error=unauthorized&redirect=matches';
                return false;
            }

            // Show profile incomplete banner if needed
            if (!session.user.profileComplete) {
                document.getElementById('profile-incomplete').style.display = 'block';
            }

            return session.user.email;
        }

        function getLoggedInUserEmail() {
            return checkAuthentication();
        }

        async function loadMatches() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const containerEl = document.getElementById('matches-container');
            const subtitleEl = document.getElementById('subtitle');

            try {
                const userEmail = getLoggedInUserEmail();
                
                if (!userEmail) return; // Authentication check failed, already redirected

                const response = await fetch('/.netlify/functions/matchProviders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email: userEmail })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load matches');
                }

                loadingEl.style.display = 'none';

                if (data.matches && data.matches.length > 0) {
                    allMatches = data.matches;
                    const matchText = data.matches.length === 1 ? 'amazing caregiver' : 'amazing caregivers';
                    subtitleEl.textContent = `We found ${data.matches.length} ${matchText} who will love caring for your family`;
                    renderMatches(data.matches);
                    setupFilters();
                } else {
                    renderNoMatches();
                }

            } catch (error) {
                console.error('Error loading matches:', error);
                loadingEl.style.display = 'none';
                errorEl.textContent = error.message;
                errorEl.style.display = 'block';
            }
        }

        function renderMatches(matches) {
            const container = document.getElementById('matches-container');
            container.innerHTML = '';
            
            const grid = document.createElement('div');
            grid.className = 'matches-grid';

            matches.forEach(provider => {
                const card = createProviderCard(provider);
                grid.appendChild(card);
            });

            container.appendChild(grid);
        }

        function createProviderCard(provider) {
            const card = document.createElement('div');
            card.className = 'provider-card card hover-scale';

            // Fixed match score calculation
            const matchPercentage = Math.round(provider.matchScore);
            const initials = provider.fullName.split(' ').map(n => n[0]).join('').toUpperCase();
            const isFavorited = favorites.includes(provider.id);

            const limitedTags = (items, maxShow = 3) => {
                if (!items || items.length === 0) return '';
                
                const visible = items.slice(0, maxShow);
                const remaining = items.length - maxShow;
                
                let html = visible.map(item => `<span class="tag">${item}</span>`).join('');
                
                if (remaining > 0) {
                    html += `<span class="tag tag-more" onclick="showAllTags(this, ${JSON.stringify(items).replace(/"/g, '&quot;')})">+${remaining} more</span>`;
                }
                
                return html;
            };

            const avatarHtml = provider.avatarUrl 
                ? `<img src="${provider.avatarUrl}" alt="${provider.fullName}" class="provider-avatar-img" loading="lazy" />`
                : initials;

            // Filter out low-quality matches (below 40%)
            if (matchPercentage < 40) {
                return null;
            }

            card.innerHTML = `
                <div class="provider-header">
                    <div class="provider-info-header">
                        <div class="provider-avatar">${avatarHtml}</div>
                        <div class="provider-details">
                            <div class="provider-name">${provider.fullName}</div>
                            <div class="background-check ${provider.backgroundCheck === 'Passed' || provider.backgroundCheck === 'Completed' ? 'check-passed' : 'check-pending'}">
                                ${provider.backgroundCheck === 'Passed' || provider.backgroundCheck === 'Completed' ? 'Verified' : 'Pending'}
                            </div>
                        </div>
                    </div>
                    <div class="match-score">${matchPercentage}% Match</div>
                </div>

                <div class="provider-info">
                    <div class="info-section">
                        <span class="info-label">Care Services</span>
                        <div class="tag-container">
                            ${limitedTags(provider.careTypes)}
                        </div>
                    </div>

                    <div class="info-section">
                        <span class="info-label">Age Groups</span>
                        <div class="tag-container">
                            ${limitedTags(provider.ageGroups)}
                        </div>
                    </div>

                    <div class="info-section">
                        <span class="info-label">Languages</span>
                        <div class="tag-container">
                            ${limitedTags(provider.languages)}
                        </div>
                    </div>

                    <div class="info-section">
                        <span class="info-label">Available Days</span>
                        <div class="tag-container">
                            ${limitedTags(provider.availability)}
                        </div>
                    </div>

                    ${provider.hourlyRate || provider.neighborhood ? `
                    <div class="rate-location">
                        ${provider.hourlyRate ? `<span class="rate">$${provider.hourlyRate}/hour</span>` : '<span></span>'}
                        ${provider.neighborhood ? `<span class="location">${provider.neighborhood}</span>` : '<span></span>'}
                    </div>
                    ` : ''}
                </div>

                ${provider.matchDetails && provider.matchDetails.length > 0 ? `
                <div class="match-details">
                    <h4>Why this is a perfect match:</h4>
                    <ul>
                        ${provider.matchDetails.map(detail => `<li>${detail}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}

                <div class="card-actions">
                    <button class="btn btn-primary" onclick="requestIntro(event, '${provider.id}', '${provider.fullName}')">
                        Request Introduction
                    </button>
                    <button class="btn btn-secondary ${isFavorited ? 'favorited' : ''}" 
                            onclick="toggleFavorite('${provider.id}', this)"
                            aria-pressed="${isFavorited}"
                            aria-label="${isFavorited ? 'Remove from favorites' : 'Add to favorites'}">
                        ${isFavorited ? '♥' : '♡'}
                    </button>
                </div>
            `;

            return card;
        }

        function showAllTags(element, allItems) {
            const container = element.parentElement;
            container.innerHTML = allItems.map(item => `<span class="tag">${item}</span>`).join('');
        }

        function setupFilters() {
            document.getElementById('sort-filter').addEventListener('change', applyFilters);
            document.getElementById('bg-filter').addEventListener('change', applyFilters);
        }

        function applyFilters() {
            const sortBy = document.getElementById('sort-filter').value;
            const bgFilter = document.getElementById('bg-filter').value;

            let filtered = [...allMatches];

            // Apply background check filter
            if (bgFilter === 'verified') {
                filtered = filtered.filter(p => 
                    p.backgroundCheck === 'Passed' || p.backgroundCheck === 'Completed'
                );
            }

            // Apply sorting
            switch (sortBy) {
                case 'rate-low':
                    filtered.sort((a, b) => (parseFloat(a.hourlyRate) || 999) - (parseFloat(b.hourlyRate) || 999));
                    break;
                case 'rate-high':
                    filtered.sort((a, b) => (parseFloat(b.hourlyRate) || 0) - (parseFloat(a.hourlyRate) || 0));
                    break;
                case 'name':
                    filtered.sort((a, b) => a.fullName.localeCompare(b.fullName));
                    break;
                default: // score
                    filtered.sort((a, b) => b.matchScore - a.matchScore);
            }

            renderMatches(filtered);
        }

        function toggleFavorite(providerId, button) {
            const index = favorites.indexOf(providerId);
            
            if (index === -1) {
                favorites.push(providerId);
                button.classList.add('favorited');
                button.textContent = '♥';
                button.setAttribute('aria-pressed', 'true');
                button.setAttribute('aria-label', 'Remove from favorites');
                showToast('Added to favorites!');
            } else {
                favorites.splice(index, 1);
                button.classList.remove('favorited');
                button.textContent = '♡';
                button.setAttribute('aria-pressed', 'false');
                button.setAttribute('aria-label', 'Add to favorites');
                showToast('Removed from favorites');
            }
            
            localStorage.setItem('opeari_favorites', JSON.stringify(favorites));
        }

        async function requestIntro(event, providerId, providerName) {
            const button = event.target;
            const originalText = button.innerHTML;
            
            button.disabled = true;
            button.innerHTML = 'Sending...';

            try {
                // Call the backend to handle the introduction request
                const response = await fetch('/.netlify/functions/requestIntroduction', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        parentEmail: getLoggedInUserEmail(),
                        providerId: providerId,
                        providerName: providerName
                    })
                });

                if (response.ok) {
                    button.innerHTML = 'Introduction Sent!';
                    button.style.background = 'linear-gradient(135deg, #4caf50, #45a049)';
                    showToast(`You're now Opearing with ${providerName}! We'll send an intro soon.`);
                } else {
                    throw new Error('Failed to send introduction request');
                }
            } catch (error) {
                console.error('Error requesting introduction:', error);
                button.disabled = false;
                button.innerHTML = originalText;
                showToast('Something went wrong. Please try again.', 'error');
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type === 'error' ? 'error' : ''}`;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }

        function showHelp() {
            const helpMessage = `Hi! I'm Perry, your childcare helper!

Here's how our matching works:
• Higher percentages = better matches for your family's needs
• Use filters to sort by price or verification status  
• Save favorites with the heart button
• Request introductions to connect with amazing caregivers
• Complete your profile for even better matches!

Remember: Every great caregiver started as a stranger who became family. We're here to help you find yours!

Need more help? Contact our support team - we're always happy to help!`;

            alert(helpMessage);
        }

        function renderNoMatches() {
            const container = document.getElementById('matches-container');
            container.innerHTML = `
                <div class="no-matches card">
                    <h3>No matches found yet</h3>
                    <p>We're still growing our community of amazing caregivers! Try adjusting your search preferences or check back soon for new perfect matches.</p>
                </div>
            `;
        }

        // Load matches when page loads
        document.addEventListener('DOMContentLoaded', loadMatches);
    </script>
</body>
</html>
