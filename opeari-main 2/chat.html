<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chat with Sarah J. | Opeari</title>
  <link rel="icon" href="images/favicon.png" type="image/png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;600;700&display=swap" rel="stylesheet" />
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #1e6b4e;
      --primary-light: #247a59;
      --coral: #F8C3B3;
      --coral-dark: #e9a894;
      --coral-light: rgba(248, 195, 179, 0.25);
      --background: #d8f5e5;
      --background-light: #eafaf2;
      --text: #1e6b4e;
      --text-light: #4a9474;
      --white: #ffffff;
      --border: #c8e6d9;
    }
    
    html, body {
      height: 100%;
    }
    
    body {
      font-family: 'Comfortaa', sans-serif;
      background-color: var(--background);
      color: var(--text);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    /* Header */
    header {
      background: var(--white);
      padding: 0.85rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 12px rgba(30, 107, 78, 0.08);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .logo {
      height: 55px;
    }
    
    .header-nav {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    
    .nav-link {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-light);
      text-decoration: none;
      transition: color 0.2s ease;
    }
    
    .nav-link:hover, .nav-link.active {
      color: var(--primary);
    }
    
    .user-avatar {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.95rem;
      color: var(--white);
      cursor: pointer;
    }
    
    /* Chat Container */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      max-width: 700px;
      width: 100%;
      margin: 0 auto;
    }
    
    /* Chat Header */
    .chat-header {
      background: var(--white);
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      border-bottom: 1px solid var(--border);
    }
    
    .back-btn {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background-light);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      color: var(--text-light);
      transition: all 0.2s ease;
      text-decoration: none;
    }
    
    .back-btn:hover {
      background: var(--border);
      color: var(--primary);
    }
    
    .back-btn svg {
      width: 20px;
      height: 20px;
    }
    
    .chat-user {
      display: flex;
      align-items: center;
      gap: 0.85rem;
      flex: 1;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }
    
    .chat-user:hover .chat-user-name {
      color: var(--primary-light);
    }
    
    .chat-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffeee8 0%, var(--coral) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--primary);
    }
    
    .chat-user-info {
      flex: 1;
    }
    
    .chat-user-name {
      font-size: 1rem;
      font-weight: 700;
      color: var(--primary);
      transition: color 0.2s ease;
    }
    
    .chat-user-status {
      font-size: 0.75rem;
      color: var(--text-light);
    }
    
    .chat-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .chat-action-btn {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: 2px solid var(--border);
      border-radius: 50%;
      cursor: pointer;
      color: var(--text-light);
      transition: all 0.2s ease;
    }
    
    .chat-action-btn:hover {
      border-color: var(--primary);
      color: var(--primary);
    }
    
    .chat-action-btn svg {
      width: 18px;
      height: 18px;
    }
    
    /* Messages Area */
    .messages-area {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    /* Match Context Banner */
    .match-context {
      background: var(--white);
      border-radius: 16px;
      padding: 1rem 1.25rem;
      text-align: center;
      margin-bottom: 0.5rem;
      box-shadow: 0 2px 12px rgba(30, 107, 78, 0.06);
    }
    
    .match-context-label {
      font-size: 0.65rem;
      font-weight: 700;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.3rem;
    }
    
    .match-context-text {
      font-size: 0.85rem;
      color: var(--primary);
      font-weight: 600;
    }
    
    .match-context-text span {
      color: var(--coral-dark);
    }
    
    /* Date Divider */
    .date-divider {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin: 0.5rem 0;
    }
    
    .date-divider::before,
    .date-divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }
    
    .date-divider span {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--text-light);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    /* Message Bubble */
    .message {
      display: flex;
      gap: 0.65rem;
      max-width: 80%;
    }
    
    .message.sent {
      align-self: flex-end;
      flex-direction: row-reverse;
    }
    
    .message-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffeee8 0%, var(--coral) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.65rem;
      color: var(--primary);
      flex-shrink: 0;
      align-self: flex-end;
    }
    
    .message.sent .message-avatar {
      background: var(--primary);
      color: var(--white);
    }
    
    .message-bubble {
      background: var(--white);
      border-radius: 18px;
      border-bottom-left-radius: 6px;
      padding: 0.85rem 1.1rem;
      box-shadow: 0 2px 8px rgba(30, 107, 78, 0.06);
    }
    
    .message.sent .message-bubble {
      background: var(--primary);
      color: var(--white);
      border-bottom-left-radius: 18px;
      border-bottom-right-radius: 6px;
    }
    
    .message-text {
      font-size: 0.9rem;
      line-height: 1.55;
    }
    
    .message-time {
      font-size: 0.65rem;
      color: var(--text-light);
      margin-top: 0.4rem;
      opacity: 0.8;
    }
    
    .message.sent .message-time {
      color: rgba(255, 255, 255, 0.7);
      text-align: right;
    }
    
    /* Grouped messages */
    .message.no-avatar {
      margin-bottom: 0.25rem;
    }
    
    .message-avatar-spacer {
      width: 32px;
      flex-shrink: 0;
    }
    
    .message-bubble.grouped {
      margin-top: -0.5rem;
    }
    
    .message:not(.sent) .message-bubble.first {
      border-bottom-left-radius: 6px;
    }
    
    .message:not(.sent) .message-bubble.middle {
      border-top-left-radius: 6px;
      border-bottom-left-radius: 6px;
    }
    
    .message:not(.sent) .message-bubble.last {
      border-top-left-radius: 6px;
    }
    
    .message.sent .message-bubble.first {
      border-bottom-right-radius: 6px;
    }
    
    .message.sent .message-bubble.middle {
      border-top-right-radius: 6px;
      border-bottom-right-radius: 6px;
    }
    
    .message.sent .message-bubble.last {
      border-top-right-radius: 6px;
    }
    
    /* Typing Indicator */
    .typing-indicator {
      display: flex;
      gap: 0.65rem;
      max-width: 80%;
      align-items: flex-end;
    }
    
    .typing-bubble {
      background: var(--white);
      border-radius: 18px;
      border-bottom-left-radius: 6px;
      padding: 1rem 1.25rem;
      box-shadow: 0 2px 8px rgba(30, 107, 78, 0.06);
      display: flex;
      gap: 4px;
    }
    
    .typing-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-light);
      animation: typingBounce 1.4s infinite ease-in-out;
    }
    
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    @keyframes typingBounce {
      0%, 80%, 100% {
        transform: translateY(0);
        opacity: 0.4;
      }
      40% {
        transform: translateY(-6px);
        opacity: 1;
      }
    }
    
    /* Input Area */
    .input-area {
      background: var(--white);
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 0.75rem;
      align-items: flex-end;
    }
    
    .message-input-wrapper {
      flex: 1;
      background: var(--background-light);
      border-radius: 24px;
      padding: 0.25rem;
      display: flex;
      align-items: flex-end;
    }
    
    .message-input {
      flex: 1;
      border: none;
      background: none;
      padding: 0.75rem 1rem;
      font-family: 'Comfortaa', sans-serif;
      font-size: 0.9rem;
      color: var(--text);
      resize: none;
      outline: none;
      max-height: 120px;
      line-height: 1.5;
    }
    
    .message-input::placeholder {
      color: var(--text-light);
    }
    
    .send-btn {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--primary);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      color: var(--white);
      transition: all 0.2s ease;
      flex-shrink: 0;
    }
    
    .send-btn:hover {
      background: var(--primary-light);
      transform: scale(1.05);
    }
    
    .send-btn:disabled {
      background: var(--border);
      cursor: not-allowed;
      transform: none;
    }
    
    .send-btn svg {
      width: 20px;
      height: 20px;
    }
    
    /* Mobile */
    @media (max-width: 768px) {
      header { display: none; }
      
      .chat-container {
        height: 100vh;
      }
      
      .chat-header {
        padding: 0.85rem 1rem;
      }
      
      .chat-avatar {
        width: 38px;
        height: 38px;
        font-size: 0.8rem;
      }
      
      .chat-user-name {
        font-size: 0.95rem;
      }
      
      .messages-area {
        padding: 1rem;
      }
      
      .message {
        max-width: 85%;
      }
      
      .input-area {
        padding: 0.85rem 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="index.html">
      <img src="images/logo.png" alt="Opeari" class="logo" />
    </a>
    <nav class="header-nav">
      <a href="dashboard.html" class="nav-link">My Village</a>
      <a href="messages.html" class="nav-link active">Messages</a>
      <a href="saved.html" class="nav-link">Saved</a>
      <div class="user-avatar">S</div>
    </nav>
  </header>

  <div class="chat-container">
    <!-- Chat Header -->
    <div class="chat-header">
      <a href="messages.html" class="back-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </a>
      
      <a href="profile.html" class="chat-user">
        <div class="chat-avatar">SJ</div>
        <div class="chat-user-info">
          <div class="chat-user-name">Sarah J.</div>
          <div class="chat-user-status">0.4 mi away</div>
        </div>
      </a>
      
      <div class="chat-actions">
        <a href="profile.html" class="chat-action-btn" title="View Profile">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </a>
      </div>
    </div>
    
    <!-- Messages Area -->
    <div class="messages-area" id="messagesArea">
      <!-- Match Context -->
      <div class="match-context">
        <div class="match-context-label">Why you matched</div>
        <div class="match-context-text">You both need care on <span>Tue, Wed, Thu mornings</span></div>
      </div>
      
      <!-- Date Divider -->
      <div class="date-divider">
        <span>Today</span>
      </div>
      
      <!-- Messages will be populated by JS -->
    </div>
    
    <!-- Input Area -->
    <div class="input-area">
      <div class="message-input-wrapper">
        <textarea 
          class="message-input" 
          id="messageInput" 
          placeholder="Type a message..." 
          rows="1"
        ></textarea>
      </div>
      <button class="send-btn" id="sendBtn" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
      </button>
    </div>
  </div>

  <script>
    // Sample message data
    const messages = [
      {
        id: 1,
        sender: 'me',
        text: "Hi Sarah! I saw we both need care on Tue, Wed, Thu mornings â€” I think we might be a great fit for a nanny share! Would love to chat and learn more about your setup.",
        time: "10:32 AM"
      },
      {
        id: 2,
        sender: 'them',
        text: "Hi! Thanks so much for reaching out! Yes, we have a wonderful nanny named Maria who comes Tue-Thu mornings. She's been with us for a year and is amazing with kids.",
        time: "10:45 AM"
      },
      {
        id: 3,
        sender: 'them',
        text: "We've been looking for another family to share with â€” it would help with costs and give Olivia a playmate! How old are your kids?",
        time: "10:46 AM"
      },
      {
        id: 4,
        sender: 'me',
        text: "That sounds perfect! We have Emma (3) and Jake (18 months). Emma would love a playmate around her age! What's Maria's experience like?",
        time: "11:02 AM"
      },
      {
        id: 5,
        sender: 'them',
        text: "Maria has 8 years of experience and is infant/toddler certified. She's great with multiple kids â€” very patient and creative with activities. She's also CPR certified.",
        time: "11:15 AM"
      },
      {
        id: 6,
        sender: 'them',
        text: "That sounds great! Would Tuesday work for a quick coffee chat? We could meet at the park on Oak Street and the kids could play while we talk.",
        time: "11:16 AM"
      }
    ];
    
    const messagesArea = document.getElementById('messagesArea');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');
    
    function renderMessages() {
      let messagesHTML = '';
      
      messages.forEach((msg, index) => {
        const prevMsg = messages[index - 1];
        const nextMsg = messages[index + 1];
        
        // Check if this is part of a group (same sender as previous or next)
        const isFirstInGroup = !prevMsg || prevMsg.sender !== msg.sender;
        const isLastInGroup = !nextMsg || nextMsg.sender !== msg.sender;
        
        // Only show avatar on last message of a group
        const showAvatar = isLastInGroup;
        
        // Only show time on last message of a group
        const showTime = isLastInGroup;
        
        // Bubble style classes
        let bubbleClass = 'message-bubble';
        if (!isFirstInGroup) bubbleClass += ' grouped';
        if (isFirstInGroup && !isLastInGroup) bubbleClass += ' first';
        if (!isFirstInGroup && !isLastInGroup) bubbleClass += ' middle';
        if (isLastInGroup && !isFirstInGroup) bubbleClass += ' last';
        
        messagesHTML += `
          <div class="message ${msg.sender === 'me' ? 'sent' : ''} ${!showAvatar ? 'no-avatar' : ''}">
            ${showAvatar ? `<div class="message-avatar">${msg.sender === 'me' ? 'S' : 'SJ'}</div>` : '<div class="message-avatar-spacer"></div>'}
            <div class="${bubbleClass}">
              <div class="message-text">${msg.text}</div>
              ${showTime ? `<div class="message-time">${msg.time}</div>` : ''}
            </div>
          </div>
        `;
      });
      
      // Keep the context and date divider, add messages after
      const existingContent = messagesArea.innerHTML;
      const dividerIndex = existingContent.indexOf('</div>', existingContent.indexOf('date-divider')) + 6;
      messagesArea.innerHTML = existingContent.substring(0, dividerIndex) + messagesHTML;
      
      // Scroll to bottom
      messagesArea.scrollTop = messagesArea.scrollHeight;
    }
    
    function sendMessage() {
      const text = messageInput.value.trim();
      if (!text) return;
      
      // Add message to array
      const newMessage = {
        id: messages.length + 1,
        sender: 'me',
        text: text,
        time: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })
      };
      messages.push(newMessage);
      
      // Re-render
      renderMessages();
      
      // Clear input
      messageInput.value = '';
      messageInput.style.height = 'auto';
      sendBtn.disabled = true;
      
      // Simulate typing response after a delay
      setTimeout(() => {
        showTypingIndicator();
      }, 1000);
      
      setTimeout(() => {
        hideTypingIndicator();
        const response = {
          id: messages.length + 1,
          sender: 'them',
          text: "Sounds great! Looking forward to it! ðŸ˜Š",
          time: new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })
        };
        messages.push(response);
        renderMessages();
      }, 3000);
    }
    
    function showTypingIndicator() {
      const typingHTML = `
        <div class="typing-indicator" id="typingIndicator">
          <div class="message-avatar">SJ</div>
          <div class="typing-bubble">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        </div>
      `;
      messagesArea.insertAdjacentHTML('beforeend', typingHTML);
      messagesArea.scrollTop = messagesArea.scrollHeight;
    }
    
    function hideTypingIndicator() {
      const indicator = document.getElementById('typingIndicator');
      if (indicator) indicator.remove();
    }
    
    // Input handling
    messageInput.addEventListener('input', () => {
      // Auto-resize textarea
      messageInput.style.height = 'auto';
      messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
      
      // Enable/disable send button
      sendBtn.disabled = !messageInput.value.trim();
    });
    
    messageInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        if (messageInput.value.trim()) {
          sendMessage();
        }
      }
    });
    
    sendBtn.addEventListener('click', sendMessage);
    
    // Initial render
    renderMessages();
  </script>
</body>
</html>
